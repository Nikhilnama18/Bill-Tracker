{"remainingRequest":"/home/nikhil/Desktop/Project/front_end/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/home/nikhil/Desktop/Project/front_end/src/components/ListBills.vue?vue&type=template&id=144b104e","dependencies":[{"path":"/home/nikhil/Desktop/Project/front_end/src/components/ListBills.vue","mtime":1628680119302},{"path":"/home/nikhil/Desktop/Project/front_end/node_modules/cache-loader/dist/cjs.js","mtime":1626765536234},{"path":"/home/nikhil/Desktop/Project/front_end/node_modules/babel-loader/lib/index.js","mtime":1626765536666},{"path":"/home/nikhil/Desktop/Project/front_end/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1626765537058},{"path":"/home/nikhil/Desktop/Project/front_end/node_modules/cache-loader/dist/cjs.js","mtime":1626765536234},{"path":"/home/nikhil/Desktop/Project/front_end/node_modules/vue-loader-v16/dist/index.js","mtime":1626765536830}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGRpdj4KICAgIDxCdXR0b24KICAgICAgQGNsaWNrPSJzaG93QWRkQmlsbCA9ICFzaG93QWRkQmlsbCIKICAgICAgOnRpdGxlPSJzaG93QWRkQmlsbCA9PT0gZmFsc2UgPyAnQWRkIEJpbGwnIDogJ0NhbmNlbCciCiAgICAgIDpjb2xvcj0ic2hvd0FkZEJpbGwgPT09IGZhbHNlID8gJ2dyZWVuJyA6ICdyZWQnIgogICAgLz4KICAgIDxkaXYgdi1zaG93PSJzaG93QWRkQmlsbCI+CiAgICAgIDxmb3JtPgogICAgICAgIDxpbnB1dAogICAgICAgICAgdi1tb2RlbD0iYW1tb3VudCIKICAgICAgICAgIHR5cGU9Im51bWJlciIKICAgICAgICAgIG5hbWU9ImFtbW91bnQiCiAgICAgICAgICBpZD0iYW1tb3VudCIKICAgICAgICAgIHBsYWNlaG9sZGVyPSJCaWxsIEFtbW91dCIKICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgLz4KICAgICAgICA8aW5wdXQKICAgICAgICAgIHYtbW9kZWw9ImR1ZUFtbW91bnQiCiAgICAgICAgICB0eXBlPSJudW1iZXIiCiAgICAgICAgICBuYW1lPSJkdWVBbW1vdW50IgogICAgICAgICAgaWQ9ImR1ZUFtbW91bnQiCiAgICAgICAgICBwbGFjZWhvbGRlcj0iQmlsbCBEdWUgQW1tb3VudCIKICAgICAgICAgIHJlcXVpcmVkCiAgICAgICAgLz4KCiAgICAgICAgPGlucHV0CiAgICAgICAgICB2LW1vZGVsPSJiaWxsVGltZXN0YW1wIgogICAgICAgICAgdHlwZT0iZGF0ZXRpbWUtbG9jYWwiCiAgICAgICAgICBuYW1lPSJiaWxsVGltZXN0YW1wIgogICAgICAgICAgaWQ9ImJpbGxUaW1lc3RhbXAiCiAgICAgICAgICByZXF1aXJlZAogICAgICAgIC8+CgogICAgICAgIDxpbnB1dAogICAgICAgICAgdHlwZT0ic3VibWl0IgogICAgICAgICAgQGNsaWNrPSJjcmVhdGVCaWxsIgogICAgICAgICAgdmFsdWU9IkFkZCBiaWxsIgogICAgICAgICAgOnN0eWxlPSJ7IGJhY2tncm91bmQ6ICcjNDU4ZWZmJyB9IgogICAgICAgICAgY2xhc3M9ImJ0biIKICAgICAgICAvPgogICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KCiAgICA8cD5Ub3RhbCBCaWxscyA6IHt7IGJpbGxzLmxlbmd0aCB9fTwvcD4KICAgIDxwPlRvdGFsIEFtbW91bnQgOiB7eyB0b3RhbEFtbW91bnQgfX0gJiN4MjBCOTs8L3A+CiAgICA8cD5Ub3RhbCBEdWUgQW1tb3VudCA6IHt7IHRvdGFsRHVlQW1tb3VudCB9fSAmI3gyMEI5OzwvcD4KICAgIDxwPk9wZW4gYmlsbHMgRHVlIDoge3sgb3BlbkR1ZVBlcmNlbnQgfX0gJTwvcD4KICAgIDxwPk9wZW4gYmlsbHMgUGFpZCA6IHt7IDEwMCAtIG9wZW5EdWVQZXJjZW50IH19ICU8L3A+CiAgICA8ZGl2IDprZXk9ImJpbGwub19pZCIgdi1mb3I9ImJpbGwgaW4gYmlsbHMiPgogICAgICA8QmlsbAogICAgICAgIEBkZWxldGUtYmlsbD0iZGVsZXRlQmlsbCIKICAgICAgICBAdXBkYXRlLWJpbGw9InVwZGF0ZUJpbGwiCiAgICAgICAgOmJpbGw9ImJpbGwiCiAgICAgID48L0JpbGw+CiAgICA8L2Rpdj4KICA8L2Rpdj4K"},{"version":3,"sources":["/home/nikhil/Desktop/Project/front_end/src/components/ListBills.vue"],"names":[],"mappings":"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","file":"/home/nikhil/Desktop/Project/front_end/src/components/ListBills.vue","sourceRoot":"","sourcesContent":["<template>\n  <div>\n    <Button\n      @click=\"showAddBill = !showAddBill\"\n      :title=\"showAddBill === false ? 'Add Bill' : 'Cancel'\"\n      :color=\"showAddBill === false ? 'green' : 'red'\"\n    />\n    <div v-show=\"showAddBill\">\n      <form>\n        <input\n          v-model=\"ammount\"\n          type=\"number\"\n          name=\"ammount\"\n          id=\"ammount\"\n          placeholder=\"Bill Ammout\"\n          required\n        />\n        <input\n          v-model=\"dueAmmount\"\n          type=\"number\"\n          name=\"dueAmmount\"\n          id=\"dueAmmount\"\n          placeholder=\"Bill Due Ammount\"\n          required\n        />\n\n        <input\n          v-model=\"billTimestamp\"\n          type=\"datetime-local\"\n          name=\"billTimestamp\"\n          id=\"billTimestamp\"\n          required\n        />\n\n        <input\n          type=\"submit\"\n          @click=\"createBill\"\n          value=\"Add bill\"\n          :style=\"{ background: '#458eff' }\"\n          class=\"btn\"\n        />\n      </form>\n    </div>\n\n    <p>Total Bills : {{ bills.length }}</p>\n    <p>Total Ammount : {{ totalAmmount }} &#x20B9;</p>\n    <p>Total Due Ammount : {{ totalDueAmmount }} &#x20B9;</p>\n    <p>Open bills Due : {{ openDuePercent }} %</p>\n    <p>Open bills Paid : {{ 100 - openDuePercent }} %</p>\n    <div :key=\"bill.o_id\" v-for=\"bill in bills\">\n      <Bill\n        @delete-bill=\"deleteBill\"\n        @update-bill=\"updateBill\"\n        :bill=\"bill\"\n      ></Bill>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Bill from \"./Bill.vue\";\nimport Button from \"../components/Button.vue\";\n\nexport default {\n  name: \"ListBills\",\n  props: {\n    org_id: String,\n  },\n  data() {\n    return {\n      bills: [],\n      showAddBill: false,\n      dueAmmount: 0,\n      ammount: 0,\n      billTimestamp: new Date(),\n    };\n  },\n  components: { Bill, Button },\n  methods: {\n    async fetchBills() {\n      const response = await fetch(\n        `api/users/${this.getUserId()}/orgs/${this.getOrgId()}/bills`,\n        {\n          method: \"GET\",\n          headers: {\n            \"Content-type\": \"application/json\",\n            authorization: `Bearer ${this.jwtToken}`,\n          },\n        }\n      );\n      if (response.status === 200) {\n        let result = await response.json();\n        this.bills = result.data;\n      }\n    },\n\n    async createBill(event) {\n      event.preventDefault();\n\n      const response = await fetch(\n        `api/users/${this.getUserId()}/orgs/${this.getOrgId()}/bills`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            u_id: parseInt(this.getUserId()),\n            o_id: parseInt(this.getOrgId()),\n            ammount: parseInt(this.ammount),\n            due_ammount: parseInt(this.dueAmmount),\n            issue_timestamp: this.billTimestamp,\n          }),\n        }\n      );\n      if (response.status == 200) {\n        let result = await response.json();\n        if (result.statusCode == \"10000\") {\n          this.bills = [result.data[0], ...this.bills];\n          this.showAddBill = false;\n        } else {\n          alert(\"Unable to create bill.\");\n        }\n      } else {\n        alert(\"Unable to create bill.\");\n      }\n    },\n\n    async deleteBill(b_id) {\n      if (\n        confirm(`Are you sure , you want to delete the bill with id : ${b_id}`)\n      ) {\n        const response = await fetch(\n          `api/users/${this.getUserId()}/orgs/${this.getOrgId()}/bills/${b_id}`,\n          {\n            method: \"DELETE\",\n            headers: {\n              \"Content-type\": \"application/json\",\n              authorization: `Bearer ${this.getJwtToken()}`,\n            },\n          }\n        );\n\n        if (response.status == 200) {\n          let result = await response.json();\n          if (result.statusCode == \"10000\") {\n            this.bills = this.bills.filter((bill) => bill.b_id != b_id);\n          } else {\n            alert(\"Unable to delete bill.\");\n          }\n        } else {\n          alert(\"Unable to delete bill.\");\n        }\n      }\n    },\n\n    updateBill(updated_bill) {\n      console.log(updated_bill);\n      //   No need to update here , updating just in the bill component is enough.\n      //   const updatedBillIndex = this.bills.findIndex(\n      //     (bill) => bill.b_id == updated_bill.b_id\n      //   );\n      //   // Get a new object.\n      //   const toUpdateBill = { ...this.bills[updatedBillIndex] };\n      //   // Now remove the to update object.\n      //   this.bills = this.bills.filter((bill) => {\n      //     return bill.b_id != updated_bill.b_id;\n      //   });\n      //   toUpdateBill[\"ammount\"] = parseInt(updated_bill.ammount);\n      //   toUpdateBill[\"due_ammount\"] = parseInt(updated_bill.due_ammount);\n      //   this.bills.splice(updatedBillIndex, 0, { ...toUpdateBill });\n      //   console.table(this.bills);\n    },\n\n    getUserId() {\n      const u_id = localStorage.getItem(\"u_id\");\n      if (!u_id) {\n        this.$router.push(\"Login\");\n      }\n      return u_id;\n    },\n\n    getJwtToken() {\n      const jwtToken = localStorage.getItem(\"jwtToken\");\n      if (!jwtToken) {\n        this.$router.push(\"Login\");\n      }\n      return jwtToken;\n    },\n\n    getOrgId() {\n      const o_id = localStorage.getItem(\"org_id\") || this.$route.params.o_id;\n      if (!o_id) {\n        this.$router.push(\"Dashboard\");\n      }\n      return o_id;\n    },\n\n    numberWithCommas(x) {\n      return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n    },\n  },\n  computed: {\n    totalAmmount() {\n      const sumAmmount = this.bills.reduce((sum, bill) => {\n        return sum + bill.ammount;\n      }, 0);\n      return this.numberWithCommas(sumAmmount);\n    },\n\n    totalDueAmmount() {\n      //   console.log(\"totalDueAmmount :\", JSON.stringify(this.bills));\n      const sumDueAmmount = this.bills.reduce((sum, bill) => {\n        return sum + bill.due_ammount;\n      }, 0);\n      return this.numberWithCommas(sumDueAmmount);\n    },\n\n    openDuePercent() {\n      const openBills = this.bills.filter((bill) => {\n        return bill.due_ammount != 0;\n      });\n      const sumDueAmmount = this.bills.reduce((sum, bill) => {\n        return sum + bill.due_ammount;\n      }, 0);\n\n      if (openBills.length > 0) {\n        const openBillsSum = openBills.reduce((sum, bill) => {\n          return sum + bill.ammount;\n        }, 0);\n\n        return openBillsSum > 0\n          ? ((parseInt(sumDueAmmount) / parseInt(openBillsSum)) * 100).toFixed(\n              2\n            )\n          : 0;\n      }\n      return 0;\n    },\n  },\n  created() {\n    this.fetchBills();\n  },\n};\n</script>"]}]}